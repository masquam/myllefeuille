extends layout

block content
  p
  p Welcome to #{title}
  p
    h2 新着情報
  if Object.keys(docs).length == 0
    p 該当するナレッジがありません。
  else
    ul.listView(data-role='listview')
      each doc in docs
        li
          a(href=`${doc.id}.html`)
            div(style='font-size: 1.2em;') #{doc.title}
            div(style='font-size: 1.0em;') #{doc.content_summary}
            div(style='font-size: 0.8em;') #{doc.author}
  a.ui-btn.ui-btn-inline(href='/') メニュー
  script.
    var skipcount = 5;
    executeAjax('/newAjax.json', 5, renderNew)

    function executeAjax(url, skipcount, callback){
      jQuery(function($){
        $.ajax({
          url : url,
          type : 'GET',
          dataType : 'json',
          contentType : 'json',
          data : {skip: skipcount},
          cache : false,
          error : function(XMLHttpRequest, textStatus, errorThrown) {
            console.log("ajax通信に失敗しました");
          },
          success : function(response) {
            console.log("ajax通信に成功しました");
            console.log(response[0]);
            callback(response);
          }
        });
      });
    }

    function renderNew(response){
      debugger;
      resps = JSON.parse(response);
      resps.forEach(resp => {
        $('.listView').append('<li>' + resp.title + '</li>');
      });
    }
